function wppaPhotoEvaluate(){var o,e;if(e=wppaMyPhotoSelection?"my":"all",photo=jQuery("#wppaphoto-"+e+"photo").val(),wppaIsEmpty(photo))jQuery("#wppaphoto-"+e+"photo").css("color","#700"),o="";else{switch(wppaOutputType){case"shortcode":id=photo.replace(/\//g,""),id=id.split("."),id=id[0],o="[photo "+id+"]";break;case"html":if(-1!=photo.indexOf("xxx"))o="Videos are not supported here";else{var p=wppaShortcodeTemplateId;o=wppaShortcodeTemplate.split(p).join(photo)}break;case"img":if(-1!=photo.indexOf("xxx")){var t=photo.replace("xxx","");o='<video preload="metadata" style="width:100%;height:auto;" controls ><source src="'+wppaPhotoDirectory+t+'mp4" type="video/mp4"><source src="'+wppaPhotoDirectory+t+'ogg" type="video/ogg"><source src="'+wppaPhotoDirectory+t+'ogv" type="video/ogg"><source src="'+wppaPhotoDirectory+t+'webm" type="video/webm"></video>'}else o='<img src="'+wppaPhotoDirectory+photo+'" />';break;default:o="Unimplemented output type"}jQuery("#wppaphoto-"+e+"photo").css("color","#070"),o=o.replace(/"/g,"&quot;"),jQuery("#wppaphoto-photo-preview-tr").show(),wppaTinyMceBasicPhotoPreview(photo)}var a='<input type="text" id="wppaphoto-shortcode-preview" style="background-color:#ddd; width:100%; height:26px;" value="'+o+'" />';jQuery("#wppaphoto-shortcode-preview-container").html(a),!wppaIsEmpty(photo)?(jQuery("#wppaphoto-submit").show(),jQuery("#wppaphoto-submit-notok").hide()):(jQuery("#wppaphoto-submit").hide(),jQuery("#wppaphoto-submit-notok").show())}function wppaTinyMceBasicPhotoPreview(o){if(jQuery("#wppaphoto-photo-preview").html(""),"#potd"==o)jQuery("#wppaphoto-photo-preview").html(wppaNoPreview);else if(-1!=o.indexOf("xxx")){var e=o.replace("xxx","");jQuery("#wppaphoto-photo-preview").html('<video preload="metadata" style="max-width:400px; max-height:300px; margin-top:3px;" controls><source src="'+wppaPhotoDirectory+e+'mp4" type="video/mp4"><source src="'+wppaPhotoDirectory+e+'ogg" type="video/ogg"><source src="'+wppaPhotoDirectory+e+'ogv" type="video/ogg"><source src="'+wppaPhotoDirectory+e+'webm" type="video/webm"></video>')}else jQuery("#wppaphoto-photo-preview").html('<img src="'+wppaPhotoDirectory+o+'" style="max-width:400px; max-height:300px;" />')}function wppaDisplaySelectedFile(o,e){var p=jQuery("#"+o)[0].files[0].name;jQuery("#"+e).val("Upload "+p)}tinymce.PluginManager.add("wppaphoto",function(o,e){o.addButton("wppa_photo_button",{image:wppaImageDirectory+"camera32.png",tooltip:"WPPA+ Insert photo",onclick:function(){var o={modal:!0,resizable:!0,width:720,show:{effect:"fadeIn",duration:400},closeText:"",close:function(o,e){wppaMyPhotoSelection||(wppaMyPhotoSelection=!0,jQuery("#wppaphoto-allphoto-tr").hide(),jQuery("#wppaphoto-myphoto-tr").show(),jQuery("#wppaphoto-photo-preview").html(""),jQuery(".wppa-photo-select-item").prop("selected",!1),jQuery(".wppa-photo-select-item-first").prop("selected",!0))},open:function(o,e){wppaPhotoEvaluate()}};jQuery("#wppaphoto-form").dialog(o).dialog("open"),jQuery(".ui-widget-header").css({background:"none"}),jQuery(".ui-dialog").css({boxShadow:"0px 0px 5px 5px #aaaaaa",borderRadius:wppaBoxRadius+"px",padding:"8px",backgroundColor:wppaModalBgColor,boxSizing:"content-box",zIndex:1e5}),jQuery(".ui-dialog-titlebar").css({lineHeight:"0px",height:"24px"}),jQuery(".ui-dialog-title").css({position:"absolute",top:"15px"}),jQuery(".ui-button").css({backgroundImage:wppaModalQuitImg,padding:0,position:"absolute",right:"8px",top:"20px",width:"16px",height:"16px"}),jQuery(".ui-widget-overlay").css({background:"none"}),jQuery(".ui-button").attr("title","Close"),jQuery(".ui-icon-closethick").css({display:"none"})}})}),jQuery(function(){var o;o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var e=wppaAjaxUrl+"?action=wppa&wppa-action=tinymcephotodialogfront";o.onreadystatechange=function(){if(4==o.readyState&&404!=o.status){var e=o.responseText,p=jQuery(e);p.find("table");p.appendTo("body").hide(),p.find("#wppaphoto-submit").click(function(){newShortcode=jQuery("#wppaphoto-shortcode-preview").val(),newShortcode=newShortcode.replace(/&quot;/g,'"'),tinyMCE.activeEditor.execCommand("mceInsertContent",0,newShortcode),wppaMyPhotoSelection||(wppaMyPhotoSelection=!0,jQuery("#wppaphoto-allphoto-tr").hide(),jQuery("#wppaphoto-myphoto-tr").show(),jQuery("#wppaphoto-photo-preview").html(""),jQuery(".wppa-photo-select-item").prop("selected",!1),jQuery(".wppa-photo-select-item-first").prop("selected",!0),jQuery("#wppaphoto-myphoto").val("")),jQuery("#wppaphoto-form").dialog("close")})}},o.open("GET",e,!0),o.send()});var wppaMyPhotoSelection=!0;